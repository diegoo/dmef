TRUNCATE extra_abril_2;

INSERT INTO extra_abril_2
(numero_de_cliente,

min_Master_madelantodolares,
min_Master_madelantopesos,
min_Master_marca_atraso,
min_Master_mconsumosdolares,
min_Master_mconsumospesos,
min_Master_mconsumototal,
min_Master_mfinanciacion_limite,
min_Master_mlimitecompra,
min_Master_mpagado,
min_Master_mpagominimo,
min_Master_mpagosdolares,
min_Master_mpagospesos,
min_Master_msaldodolares,
min_Master_msaldopesos,
min_Master_msaldototal,
min_Master_tadelantosefectivo,
min_Master_tconsumos,

min_Visa_madelantodolares,
min_Visa_madelantopesos,
min_Visa_marca_atraso,
min_Visa_mconsumosdolares,
min_Visa_mconsumospesos,
min_Visa_mconsumototal,
min_Visa_mfinanciacion_limite,
min_Visa_mlimitecompra,
min_Visa_mpagado,
min_Visa_mpagominimo,
min_Visa_mpagosdolares,
min_Visa_mpagospesos,
min_Visa_msaldodolares,
min_Visa_msaldopesos,
min_Visa_msaldototal,
min_Visa_tadelantosefectivo,
min_Visa_tconsumos,

max_Master_madelantodolares,
max_Master_madelantopesos,
max_Master_marca_atraso,
max_Master_mconsumosdolares,
max_Master_mconsumospesos,
max_Master_mconsumototal,
max_Master_mfinanciacion_limite,
max_Master_mlimitecompra,
max_Master_mpagado,
max_Master_mpagominimo,
max_Master_mpagosdolares,
max_Master_mpagospesos,
max_Master_msaldodolares,
max_Master_msaldopesos,
max_Master_msaldototal,
max_Master_tadelantosefectivo,
max_Master_tconsumos,

max_Visa_madelantodolares,
max_Visa_madelantopesos,
max_Visa_marca_atraso,
max_Visa_mconsumosdolares,
max_Visa_mconsumospesos,
max_Visa_mconsumototal,
max_Visa_mfinanciacion_limite,
max_Visa_mlimitecompra,
max_Visa_mpagado,
max_Visa_mpagominimo,
max_Visa_mpagosdolares,
max_Visa_mpagospesos,
max_Visa_msaldodolares,
max_Visa_msaldopesos,
max_Visa_msaldototal,
max_Visa_tadelantosefectivo,
max_Visa_tconsumos,

avg_Master_madelantodolares,
avg_Master_madelantopesos,
avg_Master_marca_atraso,
avg_Master_mconsumosdolares,
avg_Master_mconsumospesos,
avg_Master_mconsumototal,
avg_Master_mfinanciacion_limite,
avg_Master_mlimitecompra,
avg_Master_mpagado,
avg_Master_mpagominimo,
avg_Master_mpagosdolares,
avg_Master_mpagospesos,
avg_Master_msaldodolares,
avg_Master_msaldopesos,
avg_Master_msaldototal,
avg_Master_tadelantosefectivo,
avg_Master_tconsumos,

avg_Visa_madelantodolares,
avg_Visa_madelantopesos,
avg_Visa_marca_atraso,
avg_Visa_mconsumosdolares,
avg_Visa_mconsumospesos,
avg_Visa_mconsumototal,
avg_Visa_mfinanciacion_limite,
avg_Visa_mlimitecompra,
avg_Visa_mpagado,
avg_Visa_mpagominimo,
avg_Visa_mpagosdolares,
avg_Visa_mpagospesos,
avg_Visa_msaldodolares,
avg_Visa_msaldopesos,
avg_Visa_msaldototal,
avg_Visa_tadelantosefectivo,
avg_Visa_tconsumos,

min_cautoservicio_transacciones,
min_ccajeros_ajenos_transacciones,
min_ccajeros_propio_transacciones,
min_ccajeros_propios_descuentos,
min_ccallcenter_transacciones,
min_ccambio_monedas_compra,
min_ccambio_monedas_venta,
min_ccheques_depositados,
min_ccheques_depositados_rechazados,
min_ccheques_emitidos,
min_ccheques_emitidos_rechazados,
min_ccomisiones_mantenimiento,
min_ccomisiones_otras,
min_ccuenta_descuentos,
min_cextraccion_autoservicio,
min_chomebanking_transacciones,
min_cprestamos_hipotecarios,
min_cprestamos_personales,
min_cprestamos_prendarios,
min_ctarjeta_debito_transacciones,
min_ctarjeta_master_descuentos,
min_ctarjeta_master_transacciones,
min_ctarjeta_visa_descuentos,
min_ctarjeta_visa_transacciones,
min_ctransferencias_emitidas,
min_ctransferencias_recibidas,

max_cautoservicio_transacciones,
max_ccajeros_ajenos_transacciones,
max_ccajeros_propio_transacciones,
max_ccajeros_propios_descuentos,
max_ccallcenter_transacciones,
max_ccambio_monedas_compra,
max_ccambio_monedas_venta,
max_ccheques_depositados,
max_ccheques_depositados_rechazados,
max_ccheques_emitidos,
max_ccheques_emitidos_rechazados,
max_ccomisiones_mantenimiento,
max_ccomisiones_otras,
max_ccuenta_descuentos,
max_cextraccion_autoservicio,
max_chomebanking_transacciones,
max_cprestamos_hipotecarios,
max_cprestamos_personales,
max_cprestamos_prendarios,
max_ctarjeta_debito_transacciones,
max_ctarjeta_master_descuentos,
max_ctarjeta_master_transacciones,
max_ctarjeta_visa_descuentos,
max_ctarjeta_visa_transacciones,
max_ctransferencias_emitidas,
max_ctransferencias_recibidas,

avg_cautoservicio_transacciones,
avg_ccajeros_ajenos_transacciones,
avg_ccajeros_propio_transacciones,
avg_ccajeros_propios_descuentos,
avg_ccallcenter_transacciones,
avg_ccambio_monedas_compra,
avg_ccambio_monedas_venta,
avg_ccheques_depositados,
avg_ccheques_depositados_rechazados,
avg_ccheques_emitidos,
avg_ccheques_emitidos_rechazados,
avg_ccomisiones_mantenimiento,
avg_ccomisiones_otras,
avg_ccuenta_descuentos,
avg_cextraccion_autoservicio,
avg_chomebanking_transacciones,
avg_cprestamos_hipotecarios,
avg_cprestamos_personales,
avg_cprestamos_prendarios,
avg_ctarjeta_debito_transacciones,
avg_ctarjeta_master_descuentos,
avg_ctarjeta_master_transacciones,
avg_ctarjeta_visa_descuentos,
avg_ctarjeta_visa_transacciones,
avg_ctransferencias_emitidas,
avg_ctransferencias_recibidas,

min_mactivos_margen,
min_marketing_coss_selling,
min_mautoservicio,
min_mbonos_corporativos,
min_mcaja_ahorro_Nopaquete,
min_mcaja_ahorro_Paquete,
min_mcaja_ahorro_dolares,
min_mcajeros_ajenos,
min_mcajeros_propio,
min_mcajeros_propios_descuentos,
min_mcambio_monedas_compra,
min_mcambio_monedas_venta,
min_mcheques_depositados,
min_mcheques_depositados_rechazados,
min_mcheques_emitidos,
min_mcheques_emitidos_rechazados,
min_mcomisiones,
min_mcomisiones_mantenimiento,
min_mcomisiones_otras,
min_mcuenta_corriente_Nopaquete,
min_mcuenta_corriente_Paquete,
min_mcuenta_corriente_dolares,
min_mcuenta_debitos_automaticos,
min_mcuenta_descuentos,
min_mcuentas_saldo,
min_mdescubierto_preacordado,
min_mextraccion_autoservicio,
min_mfondos_comunes_inversion_dolares,
min_mfondos_comunes_inversion_pesos,
min_minversiones_otras,
min_mmonedas_extranjeras,
min_mpagodeservicios,
min_mpagomiscuentas,
min_mpasivos_margen,
min_mprestamos_hipotecarios,
min_mprestamos_personales,
min_mprestamos_prendarios,
min_mrentabilidad,
min_mrentabilidad_annual,
min_mtitulos,
min_mtransferencias_emitidas,
min_mtransferencias_recibidas,
min_mttarjeta_master_debitos_automaticos,
min_mttarjeta_visa_debitos_automaticos,

max_mactivos_margen,
max_marketing_coss_selling,
max_mautoservicio,
max_mbonos_corporativos,
max_mcaja_ahorro_Nopaquete,
max_mcaja_ahorro_Paquete,
max_mcaja_ahorro_dolares,
max_mcajeros_ajenos,
max_mcajeros_propio,
max_mcajeros_propios_descuentos,
max_mcambio_monedas_compra,
max_mcambio_monedas_venta,
max_mcheques_depositados,
max_mcheques_depositados_rechazados,
max_mcheques_emitidos,
max_mcheques_emitidos_rechazados,
max_mcomisiones,
max_mcomisiones_mantenimiento,
max_mcomisiones_otras,
max_mcuenta_corriente_Nopaquete,
max_mcuenta_corriente_Paquete,
max_mcuenta_corriente_dolares,
max_mcuenta_debitos_automaticos,
max_mcuenta_descuentos,
max_mcuentas_saldo,
max_mdescubierto_preacordado,
max_mextraccion_autoservicio,
max_mfondos_comunes_inversion_dolares,
max_mfondos_comunes_inversion_pesos,
max_minversiones_otras,
max_mmonedas_extranjeras,
max_mpagodeservicios,
max_mpagomiscuentas,
max_mpasivos_margen,
max_mprestamos_hipotecarios,
max_mprestamos_personales,
max_mprestamos_prendarios,
max_mrentabilidad,
max_mrentabilidad_annual,
max_mtitulos,
max_mtransferencias_emitidas,
max_mtransferencias_recibidas,
max_mttarjeta_master_debitos_automaticos,
max_mttarjeta_visa_debitos_automaticos,

avg_mactivos_margen,
avg_marketing_coss_selling,
avg_mautoservicio,
avg_mbonos_corporativos,
avg_mcaja_ahorro_Nopaquete,
avg_mcaja_ahorro_Paquete,
avg_mcaja_ahorro_dolares,
avg_mcajeros_ajenos,
avg_mcajeros_propio,
avg_mcajeros_propios_descuentos,
avg_mcambio_monedas_compra,
avg_mcambio_monedas_venta,
avg_mcheques_depositados,
avg_mcheques_depositados_rechazados,
avg_mcheques_emitidos,
avg_mcheques_emitidos_rechazados,
avg_mcomisiones,
avg_mcomisiones_mantenimiento,
avg_mcomisiones_otras,
avg_mcuenta_corriente_Nopaquete,
avg_mcuenta_corriente_Paquete,
avg_mcuenta_corriente_dolares,
avg_mcuenta_debitos_automaticos,
avg_mcuenta_descuentos,
avg_mcuentas_saldo,
avg_mdescubierto_preacordado,
avg_mextraccion_autoservicio,
avg_mfondos_comunes_inversion_dolares,
avg_mfondos_comunes_inversion_pesos,
avg_minversiones_otras,
avg_mmonedas_extranjeras,
avg_mpagodeservicios,
avg_mpagomiscuentas,
avg_mpasivos_margen,
avg_mprestamos_hipotecarios,
avg_mprestamos_personales,
avg_mprestamos_prendarios,
avg_mrentabilidad,
avg_mrentabilidad_annual,
avg_mtitulos,
avg_mtransferencias_emitidas,
avg_mtransferencias_recibidas,
avg_mttarjeta_master_debitos_automaticos,
avg_mttarjeta_visa_debitos_automaticos,

tendencia_Master_madelantodolares,
tendencia_Master_madelantopesos,
tendencia_Master_marca_atraso,
tendencia_Master_mconsumosdolares,
tendencia_Master_mconsumospesos,
tendencia_Master_mconsumototal,
tendencia_Master_mfinanciacion_limite,
tendencia_Master_mlimitecompra,
tendencia_Master_mpagado,
tendencia_Master_mpagominimo,
tendencia_Master_mpagosdolares,
tendencia_Master_mpagospesos,
tendencia_Master_msaldodolares,
tendencia_Master_msaldopesos,
tendencia_Master_msaldototal,
tendencia_Master_tadelantosefectivo,
tendencia_Master_tconsumos,

tendencia_Visa_madelantodolares,
tendencia_Visa_madelantopesos,
tendencia_Visa_marca_atraso,
tendencia_Visa_mconsumosdolares,
tendencia_Visa_mconsumospesos,
tendencia_Visa_mconsumototal,
tendencia_Visa_mfinanciacion_limite,
tendencia_Visa_mlimitecompra,
tendencia_Visa_mpagado,
tendencia_Visa_mpagominimo,
tendencia_Visa_mpagosdolares,
tendencia_Visa_mpagospesos,
tendencia_Visa_msaldodolares,
tendencia_Visa_msaldopesos,
tendencia_Visa_msaldototal,
tendencia_Visa_tadelantosefectivo,
tendencia_Visa_tconsumos,

tendencia_mactivos_margen,
tendencia_marketing_coss_selling,
tendencia_mautoservicio,
tendencia_mbonos_corporativos,
tendencia_mcaja_ahorro_Nopaquete,
tendencia_mcaja_ahorro_Paquete,
tendencia_mcaja_ahorro_dolares,
tendencia_mcajeros_ajenos,
tendencia_mcajeros_propio,
tendencia_mcajeros_propios_descuentos,
tendencia_mcambio_monedas_compra,
tendencia_mcambio_monedas_venta,
tendencia_mcheques_depositados,
tendencia_mcheques_depositados_rechazados,
tendencia_mcheques_emitidos,
tendencia_mcheques_emitidos_rechazados,
tendencia_mcomisiones,
tendencia_mcomisiones_mantenimiento,
tendencia_mcomisiones_otras,
tendencia_mcuenta_corriente_Nopaquete,
tendencia_mcuenta_corriente_Paquete,
tendencia_mcuenta_corriente_dolares,
tendencia_mcuenta_debitos_automaticos,
tendencia_mcuenta_descuentos,
tendencia_mcuentas_saldo,
tendencia_mdescubierto_preacordado,
tendencia_mextraccion_autoservicio,
tendencia_mfondos_comunes_inversion_dolares,
tendencia_mfondos_comunes_inversion_pesos,
tendencia_minversiones_otras,
tendencia_mmonedas_extranjeras,
tendencia_mpagodeservicios,
tendencia_mpagomiscuentas,
tendencia_mpasivos_margen,
tendencia_mprestamos_hipotecarios,
tendencia_mprestamos_personales,
tendencia_mprestamos_prendarios,
tendencia_mrentabilidad,
tendencia_mrentabilidad_annual,
tendencia_mtitulos,
tendencia_mtransferencias_emitidas,
tendencia_mtransferencias_recibidas,
tendencia_mttarjeta_master_debitos_automaticos,
tendencia_mttarjeta_visa_debitos_automaticos,

rel_Visa_Finiciomora,
rel_Master_Finiciomora,

rel_Visa_fechaalta,
rel_Master_fechaalta

)

SELECT
numero_de_cliente,

MIN(Master_madelantodolares),
MIN(Master_madelantopesos),
MIN(Master_marca_atraso),
MIN(Master_mconsumosdolares),
MIN(Master_mconsumospesos),
MIN(Master_mconsumototal),
MIN(Master_mfinanciacion_limite),
MIN(Master_mlimitecompra),
MIN(Master_mpagado),
MIN(Master_mpagominimo),
MIN(Master_mpagosdolares),
MIN(Master_mpagospesos),
MIN(Master_msaldodolares),
MIN(Master_msaldopesos),
MIN(Master_msaldototal),
MIN(Master_tadelantosefectivo),
MIN(Master_tconsumos),

MIN(Visa_madelantodolares),
MIN(Visa_madelantopesos),
MIN(Visa_marca_atraso),
MIN(Visa_mconsumosdolares),
MIN(Visa_mconsumospesos),
MIN(Visa_mconsumototal),
MIN(Visa_mfinanciacion_limite),
MIN(Visa_mlimitecompra),
MIN(Visa_mpagado),
MIN(Visa_mpagominimo),
MIN(Visa_mpagosdolares),
MIN(Visa_mpagospesos),
MIN(Visa_msaldodolares),
MIN(Visa_msaldopesos),
MIN(Visa_msaldototal),
MIN(Visa_tadelantosefectivo),
MIN(Visa_tconsumos),

MAX(Master_madelantodolares),
MAX(Master_madelantopesos),
MAX(Master_marca_atraso),
MAX(Master_mconsumosdolares),
MAX(Master_mconsumospesos),
MAX(Master_mconsumototal),
MAX(Master_mfinanciacion_limite),
MAX(Master_mlimitecompra),
MAX(Master_mpagado),
MAX(Master_mpagominimo),
MAX(Master_mpagosdolares),
MAX(Master_mpagospesos),
MAX(Master_msaldodolares),
MAX(Master_msaldopesos),
MAX(Master_msaldototal),
MAX(Master_tadelantosefectivo),
MAX(Master_tconsumos),

MAX(Visa_madelantodolares),
MAX(Visa_madelantopesos),
MAX(Visa_marca_atraso),
MAX(Visa_mconsumosdolares),
MAX(Visa_mconsumospesos),
MAX(Visa_mconsumototal),
MAX(Visa_mfinanciacion_limite),
MAX(Visa_mlimitecompra),
MAX(Visa_mpagado),
MAX(Visa_mpagominimo),
MAX(Visa_mpagosdolares),
MAX(Visa_mpagospesos),
MAX(Visa_msaldodolares),
MAX(Visa_msaldopesos),
MAX(Visa_msaldototal),
MAX(Visa_tadelantosefectivo),
MAX(Visa_tconsumos),

AVG(Master_madelantodolares),
AVG(Master_madelantopesos),
AVG(Master_marca_atraso),
AVG(Master_mconsumosdolares),
AVG(Master_mconsumospesos),
AVG(Master_mconsumototal),
AVG(Master_mfinanciacion_limite),
AVG(Master_mlimitecompra),
AVG(Master_mpagado),
AVG(Master_mpagominimo),
AVG(Master_mpagosdolares),
AVG(Master_mpagospesos),
AVG(Master_msaldodolares),
AVG(Master_msaldopesos),
AVG(Master_msaldototal),
AVG(Master_tadelantosefectivo),
AVG(Master_tconsumos),

AVG(Visa_madelantodolares),
AVG(Visa_madelantopesos),
AVG(Visa_marca_atraso),
AVG(Visa_mconsumosdolares),
AVG(Visa_mconsumospesos),
AVG(Visa_mconsumototal),
AVG(Visa_mfinanciacion_limite),
AVG(Visa_mlimitecompra),
AVG(Visa_mpagado),
AVG(Visa_mpagominimo),
AVG(Visa_mpagosdolares),
AVG(Visa_mpagospesos),
AVG(Visa_msaldodolares),
AVG(Visa_msaldopesos),
AVG(Visa_msaldototal),
AVG(Visa_tadelantosefectivo),
AVG(Visa_tconsumos),

MIN(cautoservicio_transacciones),
MIN(ccajeros_ajenos_transacciones),
MIN(ccajeros_propio_transacciones),
MIN(ccajeros_propios_descuentos),
MIN(ccallcenter_transacciones),
MIN(ccambio_monedas_compra),
MIN(ccambio_monedas_venta),
MIN(ccheques_depositados),
MIN(ccheques_depositados_rechazados),
MIN(ccheques_emitidos),
MIN(ccheques_emitidos_rechazados),
MIN(ccomisiones_mantenimiento),
MIN(ccomisiones_otras),
MIN(ccuenta_descuentos),
MIN(cextraccion_autoservicio),
MIN(chomebanking_transacciones),
MIN(cprestamos_hipotecarios),
MIN(cprestamos_personales),
MIN(cprestamos_prendarios),
MIN(ctarjeta_debito_transacciones),
MIN(ctarjeta_master_descuentos),
MIN(ctarjeta_master_transacciones),
MIN(ctarjeta_visa_descuentos),
MIN(ctarjeta_visa_transacciones),
MIN(ctransferencias_emitidas),
MIN(ctransferencias_recibidas),

MAX(cautoservicio_transacciones),
MAX(ccajeros_ajenos_transacciones),
MAX(ccajeros_propio_transacciones),
MAX(ccajeros_propios_descuentos),
MAX(ccallcenter_transacciones),
MAX(ccambio_monedas_compra),
MAX(ccambio_monedas_venta),
MAX(ccheques_depositados),
MAX(ccheques_depositados_rechazados),
MAX(ccheques_emitidos),
MAX(ccheques_emitidos_rechazados),
MAX(ccomisiones_mantenimiento),
MAX(ccomisiones_otras),
MAX(ccuenta_descuentos),
MAX(cextraccion_autoservicio),
MAX(chomebanking_transacciones),
MAX(cprestamos_hipotecarios),
MAX(cprestamos_personales),
MAX(cprestamos_prendarios),
MAX(ctarjeta_debito_transacciones),
MAX(ctarjeta_master_descuentos),
MAX(ctarjeta_master_transacciones),
MAX(ctarjeta_visa_descuentos),
MAX(ctarjeta_visa_transacciones),
MAX(ctransferencias_emitidas),
MAX(ctransferencias_recibidas),

AVG(cautoservicio_transacciones),
AVG(ccajeros_ajenos_transacciones),
AVG(ccajeros_propio_transacciones),
AVG(ccajeros_propios_descuentos),
AVG(ccallcenter_transacciones),
AVG(ccambio_monedas_compra),
AVG(ccambio_monedas_venta),
AVG(ccheques_depositados),
AVG(ccheques_depositados_rechazados),
AVG(ccheques_emitidos),
AVG(ccheques_emitidos_rechazados),
AVG(ccomisiones_mantenimiento),
AVG(ccomisiones_otras),
AVG(ccuenta_descuentos),
AVG(cextraccion_autoservicio),
AVG(chomebanking_transacciones),
AVG(cprestamos_hipotecarios),
AVG(cprestamos_personales),
AVG(cprestamos_prendarios),
AVG(ctarjeta_debito_transacciones),
AVG(ctarjeta_master_descuentos),
AVG(ctarjeta_master_transacciones),
AVG(ctarjeta_visa_descuentos),
AVG(ctarjeta_visa_transacciones),
AVG(ctransferencias_emitidas),
AVG(ctransferencias_recibidas),

MIN(mactivos_margen),
MIN(marketing_coss_selling),
MIN(mautoservicio),
MIN(mbonos_corporativos),
MIN(mcaja_ahorro_Nopaquete),
MIN(mcaja_ahorro_Paquete),
MIN(mcaja_ahorro_dolares),
MIN(mcajeros_ajenos),
MIN(mcajeros_propio),
MIN(mcajeros_propios_descuentos),
MIN(mcambio_monedas_compra),
MIN(mcambio_monedas_venta),
MIN(mcheques_depositados),
MIN(mcheques_depositados_rechazados),
MIN(mcheques_emitidos),
MIN(mcheques_emitidos_rechazados),
MIN(mcomisiones),
MIN(mcomisiones_mantenimiento),
MIN(mcomisiones_otras),
MIN(mcuenta_corriente_Nopaquete),
MIN(mcuenta_corriente_Paquete),
MIN(mcuenta_corriente_dolares),
MIN(mcuenta_debitos_automaticos),
MIN(mcuenta_descuentos),
MIN(mcuentas_saldo),
MIN(mdescubierto_preacordado),
MIN(mextraccion_autoservicio),
MIN(mfondos_comunes_inversion_dolares),
MIN(mfondos_comunes_inversion_pesos),
MIN(minversiones_otras),
MIN(mmonedas_extranjeras),
MIN(mpagodeservicios),
MIN(mpagomiscuentas),
MIN(mpasivos_margen),
MIN(mprestamos_hipotecarios),
MIN(mprestamos_personales),
MIN(mprestamos_prendarios),
MIN(mrentabilidad),
MIN(mrentabilidad_annual),
MIN(mtitulos),
MIN(mtransferencias_emitidas),
MIN(mtransferencias_recibidas),
MIN(mttarjeta_master_debitos_automaticos),
MIN(mttarjeta_visa_debitos_automaticos),

MAX(mactivos_margen),
MAX(marketing_coss_selling),
MAX(mautoservicio),
MAX(mbonos_corporativos),
MAX(mcaja_ahorro_Nopaquete),
MAX(mcaja_ahorro_Paquete),
MAX(mcaja_ahorro_dolares),
MAX(mcajeros_ajenos),
MAX(mcajeros_propio),
MAX(mcajeros_propios_descuentos),
MAX(mcambio_monedas_compra),
MAX(mcambio_monedas_venta),
MAX(mcheques_depositados),
MAX(mcheques_depositados_rechazados),
MAX(mcheques_emitidos),
MAX(mcheques_emitidos_rechazados),
MAX(mcomisiones),
MAX(mcomisiones_mantenimiento),
MAX(mcomisiones_otras),
MAX(mcuenta_corriente_Nopaquete),
MAX(mcuenta_corriente_Paquete),
MAX(mcuenta_corriente_dolares),
MAX(mcuenta_debitos_automaticos),
MAX(mcuenta_descuentos),
MAX(mcuentas_saldo),
MAX(mdescubierto_preacordado),
MAX(mextraccion_autoservicio),
MAX(mfondos_comunes_inversion_dolares),
MAX(mfondos_comunes_inversion_pesos),
MAX(minversiones_otras),
MAX(mmonedas_extranjeras),
MAX(mpagodeservicios),
MAX(mpagomiscuentas),
MAX(mpasivos_margen),
MAX(mprestamos_hipotecarios),
MAX(mprestamos_personales),
MAX(mprestamos_prendarios),
MAX(mrentabilidad),
MAX(mrentabilidad_annual),
MAX(mtitulos),
MAX(mtransferencias_emitidas),
MAX(mtransferencias_recibidas),
MAX(mttarjeta_master_debitos_automaticos),
MAX(mttarjeta_visa_debitos_automaticos),

AVG(mactivos_margen),
AVG(marketing_coss_selling),
AVG(mautoservicio),
AVG(mbonos_corporativos),
AVG(mcaja_ahorro_Nopaquete),
AVG(mcaja_ahorro_Paquete),
AVG(mcaja_ahorro_dolares),
AVG(mcajeros_ajenos),
AVG(mcajeros_propio),
AVG(mcajeros_propios_descuentos),
AVG(mcambio_monedas_compra),
AVG(mcambio_monedas_venta),
AVG(mcheques_depositados),
AVG(mcheques_depositados_rechazados),
AVG(mcheques_emitidos),
AVG(mcheques_emitidos_rechazados),
AVG(mcomisiones),
AVG(mcomisiones_mantenimiento),
AVG(mcomisiones_otras),
AVG(mcuenta_corriente_Nopaquete),
AVG(mcuenta_corriente_Paquete),
AVG(mcuenta_corriente_dolares),
AVG(mcuenta_debitos_automaticos),
AVG(mcuenta_descuentos),
AVG(mcuentas_saldo),
AVG(mdescubierto_preacordado),
AVG(mextraccion_autoservicio),
AVG(mfondos_comunes_inversion_dolares),
AVG(mfondos_comunes_inversion_pesos),
AVG(minversiones_otras),
AVG(mmonedas_extranjeras),
AVG(mpagodeservicios),
AVG(mpagomiscuentas),
AVG(mpasivos_margen),
AVG(mprestamos_hipotecarios),
AVG(mprestamos_personales),
AVG(mprestamos_prendarios),
AVG(mrentabilidad),
AVG(mrentabilidad_annual),
AVG(mtitulos),
AVG(mtransferencias_emitidas),
AVG(mtransferencias_recibidas),
AVG(mttarjeta_master_debitos_automaticos),
AVG(mttarjeta_visa_debitos_automaticos),

GROUP_CONCAT(Master_madelantodolares),
GROUP_CONCAT(Master_madelantopesos),
GROUP_CONCAT(Master_marca_atraso),
GROUP_CONCAT(Master_mconsumosdolares),
GROUP_CONCAT(Master_mconsumospesos),
GROUP_CONCAT(Master_mconsumototal),
GROUP_CONCAT(Master_mfinanciacion_limite),
GROUP_CONCAT(Master_mlimitecompra),
GROUP_CONCAT(Master_mpagado),
GROUP_CONCAT(Master_mpagominimo),
GROUP_CONCAT(Master_mpagosdolares),
GROUP_CONCAT(Master_mpagospesos),
GROUP_CONCAT(Master_msaldodolares),
GROUP_CONCAT(Master_msaldopesos),
GROUP_CONCAT(Master_msaldototal),
GROUP_CONCAT(Master_tadelantosefectivo),
GROUP_CONCAT(Master_tconsumos),

GROUP_CONCAT(Visa_madelantodolares),
GROUP_CONCAT(Visa_madelantopesos),
GROUP_CONCAT(Visa_marca_atraso),
GROUP_CONCAT(Visa_mconsumosdolares),
GROUP_CONCAT(Visa_mconsumospesos),
GROUP_CONCAT(Visa_mconsumototal),
GROUP_CONCAT(Visa_mfinanciacion_limite),
GROUP_CONCAT(Visa_mlimitecompra),
GROUP_CONCAT(Visa_mpagado),
GROUP_CONCAT(Visa_mpagominimo),
GROUP_CONCAT(Visa_mpagosdolares),
GROUP_CONCAT(Visa_mpagospesos),
GROUP_CONCAT(Visa_msaldodolares),
GROUP_CONCAT(Visa_msaldopesos),
GROUP_CONCAT(Visa_msaldototal),
GROUP_CONCAT(Visa_tadelantosefectivo),
GROUP_CONCAT(Visa_tconsumos),

GROUP_CONCAT(mactivos_margen),
GROUP_CONCAT(marketing_coss_selling),
GROUP_CONCAT(mautoservicio),
GROUP_CONCAT(mbonos_corporativos),
GROUP_CONCAT(mcaja_ahorro_Nopaquete),
GROUP_CONCAT(mcaja_ahorro_Paquete),
GROUP_CONCAT(mcaja_ahorro_dolares),
GROUP_CONCAT(mcajeros_ajenos),
GROUP_CONCAT(mcajeros_propio),
GROUP_CONCAT(mcajeros_propios_descuentos),
GROUP_CONCAT(mcambio_monedas_compra),
GROUP_CONCAT(mcambio_monedas_venta),
GROUP_CONCAT(mcheques_depositados),
GROUP_CONCAT(mcheques_depositados_rechazados),
GROUP_CONCAT(mcheques_emitidos),
GROUP_CONCAT(mcheques_emitidos_rechazados),
GROUP_CONCAT(mcomisiones),
GROUP_CONCAT(mcomisiones_mantenimiento),
GROUP_CONCAT(mcomisiones_otras),
GROUP_CONCAT(mcuenta_corriente_Nopaquete),
GROUP_CONCAT(mcuenta_corriente_Paquete),
GROUP_CONCAT(mcuenta_corriente_dolares),
GROUP_CONCAT(mcuenta_debitos_automaticos),
GROUP_CONCAT(mcuenta_descuentos),
GROUP_CONCAT(mcuentas_saldo),
GROUP_CONCAT(mdescubierto_preacordado),
GROUP_CONCAT(mextraccion_autoservicio),
GROUP_CONCAT(mfondos_comunes_inversion_dolares),
GROUP_CONCAT(mfondos_comunes_inversion_pesos),
GROUP_CONCAT(minversiones_otras),
GROUP_CONCAT(mmonedas_extranjeras),
GROUP_CONCAT(mpagodeservicios),
GROUP_CONCAT(mpagomiscuentas),
GROUP_CONCAT(mpasivos_margen),
GROUP_CONCAT(mprestamos_hipotecarios),
GROUP_CONCAT(mprestamos_personales),
GROUP_CONCAT(mprestamos_prendarios),
GROUP_CONCAT(mrentabilidad),
GROUP_CONCAT(mrentabilidad_annual),
GROUP_CONCAT(mtitulos),
GROUP_CONCAT(mtransferencias_emitidas),
GROUP_CONCAT(mtransferencias_recibidas),
GROUP_CONCAT(mttarjeta_master_debitos_automaticos),
GROUP_CONCAT(mttarjeta_visa_debitos_automaticos),

IF(SUM(Master_Finiciomora) = 0, 0, DATEDIFF(DATE(STR_TO_DATE('201604','%Y%m')), DATE(STR_TO_DATE(Master_Finiciomora,'%Y%m%d')))),
IF(SUM(Visa_Finiciomora) = 0, 0, DATEDIFF(DATE(STR_TO_DATE('201604','%Y%m')), DATE(STR_TO_DATE(Visa_Finiciomora,'%Y%m%d')))),

DATEDIFF(DATE(STR_TO_DATE('201604','%Y%m')), DATE(STR_TO_DATE(Master_Finiciomora,'%Y%m%d'))),
DATEDIFF(DATE(STR_TO_DATE('201604','%Y%m')), DATE(STR_TO_DATE(Visa_Finiciomora,'%Y%m%d')))

FROM hasta_abril
WHERE numero_de_cliente IN (SELECT numero_de_cliente FROM hasta_abril WHERE foto_mes = 201604)
GROUP BY numero_de_cliente
ORDER BY numero_de_cliente ASC;
